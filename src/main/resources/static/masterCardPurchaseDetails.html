<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>主卡进货明细</title>

    <link rel="stylesheet" type="text/css" href="themes/bootstrap/easyui.css"></link>
    <link rel="stylesheet" type="text/css" href="themes/icon.css"></link>
    <link rel="stylesheet" type="text/css" href="themes/color.css"></link>
    <script type="text/javascript" src="jquery.min.js"></script>
    <script type="text/javascript" src="jquery.easyui.min.js"></script>
    <script type="text/javascript" src="locale/easyui-lang-zh_CN.js"></script>
    <script>
        $(function(){
            $('#masterCardPurchaseDetailsDg').datagrid({
                columns:[[
                    {field:'id',title:'ID',width:50},
                    {field:'openCardCompanyName',title:'开卡公司',width:50},
                    {field:'masterCardNum',title:'主卡卡号',width:50},
                    {field:'transferTime',title:'转账时间',width:50},
                    {field:'accountingTime',title:'上账时间',width:50},
                    {field:'rechargeAmount',title:'充值面额',width:50},
                    {field:'transferAmount',title:'转账金额',width:50},
                    {field:'discount',title:'折扣',width:50, formatter: function(value,row,index){return value+"%"}},
                    {field:'remarks',title:'备注',width:50},
                    {field:'operation',title:'操作',width:50,align:'center',formatter:function (value, row, index) {
                            var operation = "<a onclick='Edit(" + row.id + ")'>修改</a> | <a onclick='Delete(" + row.id + ")'>删除</a>";
                            return operation;
                        }
                    }
                ]],
                url:'/masterCardPurchaseDetails/page',
                method:'post',
                contentType:"application/json;charset=utf-8",
                toolbar:"#toolbar",
                pagination:true,
                rownumbers:true,
                fitColumns:true,
                singleSelect:true,
                queryParams: {
                    openCardCompanyName: ''
                }

            });
            $('#AddWin').window('close');

        });

        function Edit(id) {
           alert(id);
        }

        function Delete(id) {
           alert(id);
        }

        function Search() {
            var param = $('#masterCardPurchaseDetailsSearch').textbox('getValue');
            var queryParams = $('#masterCardPurchaseDetailsDg').datagrid('options').queryParams;
            queryParams.openCardCompanyName = param;
            $('#masterCardPurchaseDetailsDg').datagrid('reload');
        }

        function Save() {
            $('#AddWin').window('open');
        }

        function Submit() {
            // 显示进度条
            $.messager.progress();
            $('#AddForm').form('submit', {
                url: '/masterCardPurchaseDetails/save',
                onSubmit: function(){
                    var isValid = $(this).form('validate');
                    if (!isValid){
                        // 如果表单是无效的则隐藏进度条
                        $.messager.progress('close');
                        $.messager.alert('提示','请填写必填项');
                    }
                    // 返回false终止表单提交
                    return isValid;
                },
                success: function(data){
                    // 如果提交成功则隐藏进度条
                    $.messager.progress('close');
                    $.messager.alert('提示','新增成功','info');
                    $('#AddForm').form('clear')
                    $('#AddWin').window('close');
                    $('#masterCardPurchaseDetailsDg').datagrid('reload');
                }
            });

        }

        function Cancel() {
            $('#AddForm').form('clear')
            $('#AddWin').window('close');
        }
    </script>
</head>
<body>
<div>
    <table id="masterCardPurchaseDetailsDg">
        <thead>
        <tr>
            <th field="id" width="50" checkbox="true">ID</th>
            <th field="openCardCompanyName" width="50">开卡公司</th>
            <th field="masterCardNum" width="50">主卡卡号</th>
            <th field="transferTime" width="50">转账时间</th>
            <th field="accountingTime" width="50">上账时间</th>
            <th field="rechargeAmount" width="50">充值面额</th>
            <th field="transferAmount" width="50">转账金额</th>
            <th field="discount" width="50">折扣</th>
            <th field="remarks" width="50">备注</th>
            <th field="operation" width="50">操作</th>
        </tr>
        </thead>
       <div id="masterCardPurchaseDetailsTb">
           <input id="masterCardPurchaseDetailsSearch" type="text" class="easyui-textbox"></input>
           <button class="easyui-linkbutton"  onclick="Search()" data-options="iconCls:'icon-search',plain:true">搜索</button>
           <button class="easyui-linkbutton" onclick="Save()" data-options="iconCls:'icon-edit',plain:true">新增</button>
        </div>
    </table>


    <div id="AddWin" class="easyui-window" title="编辑主卡进货明细" style="width: 50%; height: auto" data-options="closed:false,collapsible:false,minimizable:false,maximizable:false">
            <form id="AddForm" method="post">
                <table>
                    <tr>
                        <td>开卡公司:</td>
                        <td>
                            <input class="easyui-textbox" type="text" name="openCardCompanyName" data-options="required:true"/>
                        </td>
                        <td>主卡卡号:</td>
                        <td>
                            <input class="easyui-textbox" name="masterCardNum" data-options="required:true"/>
                        </td>
                    </tr>
                    <tr>
                        <td>转账时间:</td>
                        <td>
                            <input class="easyui-datetimebox" name="transferTime" data-options="required:true"/>
                        </td>
                        <td>上账时间:</td>
                        <td>
                            <input class="easyui-datetimebox" name="accountingTime" data-options="required:true"/>
                        </td>
                    </tr>
                    <tr>
                        <td>充值面额:</td>
                        <td>
                            <input class="easyui-numberbox" name="rechargeAmount" data-options="required:true,min:0,precision:2"/>
                        </td>
                        <td>转账金额:</td>
                        <td>
                            <input class="easyui-numberbox" name="transferAmount" data-options="required:true,min:0,precision:2"/>
                        </td>
                    </tr>
                    <tr>
                        <td>折扣:</td>
                        <td>
                            <input class="easyui-numberbox" name="discount" data-options="required:true,max:100"/>
                        </td>
                        <td>备注:</td>
                        <td>
                            <textarea class="easyui-textbox" name="remarks" ></textarea>
                        </td>
                    </tr>
                </table>

                <div>
                    <a class="easyui-linkbutton" data-options="iconCls:'icon-cancel'" style="float:right" onclick="Cancel()">取消</a>
                    <a class="easyui-linkbutton" data-options="iconCls:'icon-ok'"  style="float:right" onclick="Submit()">确定</a>
                </div>
            </form>
    </div>
</div>
</body>
</html>